<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: view.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: view.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as base from './baseview';
import { utils } from './utils';
const kUIRegExp = /@ui.([a-zA-Z_\-\$#]+)/i;
export function normalizeUIKeys(obj, uimap) {
    /*jshint -W030 */
    let o = {}, k, v, ms, sel, ui;
    for (k in obj) {
        v = obj[k];
        if ((ms = kUIRegExp.exec(k)) !== null) {
            ui = ms[1], sel = uimap[ui];
            if (sel != null) {
                k = k.replace(ms[0], sel);
            }
        }
        o[k] = v;
    }
    return o;
}
export class View extends base.BaseView {
    /**
     * View
     * @param {ViewOptions} options
     * @extends BaseView
     */
    constructor(options) {
        this._options = options;
        super(options);
    }
    delegateEvents(events) {
        this.bindUIElements();
        events = events || this.events;
        events = normalizeUIKeys(events, this._ui);
        let triggers = this._configureTriggers();
        events = utils.extend({}, events, triggers);
        super.delegateEvents(events);
        return this;
    }
    undelegateEvents() {
        this.unbindUIElements();
        super.undelegateEvents();
        return this;
    }
    /* UI Elements */
    bindUIElements() {
        let ui = this.getOption('ui'); //this.options.ui||this.ui
        if (!ui)
            return;
        if (!this._ui) {
            this._ui = ui;
        }
        ui = utils.result(this, '_ui');
        this.ui = {};
        Object.keys(ui).forEach((k) => {
            let elm = this.$(ui[k]);
            if (elm &amp;&amp; elm.length) {
                // unwrap if it's a nodelist.
                if (elm instanceof NodeList) {
                    elm = elm[0];
                }
                this.ui[k] = elm;
            }
        });
    }
    unbindUIElements() {
        this.ui = {};
    }
    /**
     * Configure triggers
     * @return {Object} events object
     * @private
     */
    _configureTriggers() {
        /*if (!this.triggers) {
          return {};
        }*/
        let triggers = this.getOption('triggers') || {};
        if (typeof triggers === 'function') {
            triggers = triggers.call(this);
        }
        // Allow `triggers` to be configured as a function
        triggers = normalizeUIKeys(triggers, this._ui);
        // Configure the triggers, prevent default
        // action and stop propagation of DOM events
        let events = {}, val, key;
        for (key in triggers) {
            val = triggers[key];
            events[key] = this._buildViewTrigger(val);
        }
        return events;
    }
    /**
     * builder trigger function
     * @param  {Object|String} triggerDef Trigger definition
     * @return {Function}
     * @private
     */
    _buildViewTrigger(triggerDef) {
        if (typeof triggerDef === 'string')
            triggerDef = { event: triggerDef };
        let options = utils.extend({
            preventDefault: true,
            stopPropagation: true
        }, triggerDef);
        return function (e) {
            if (e) {
                if (e.preventDefault &amp;&amp; options.preventDefault) {
                    e.preventDefault();
                }
                if (e.stopPropagation &amp;&amp; options.stopPropagation) {
                    e.stopPropagation();
                }
            }
            this.triggerMethod(options.event, {
                view: this,
                model: this.model,
                collection: this.collection
            });
        };
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-utils.html">utils</a></li></ul><h3>Classes</h3><ul><li><a href="-_.html"></a></li><li><a href="BaseObject.html">BaseObject</a></li><li><a href="BaseView.html">BaseView</a></li><li><a href="CollectionView.html">CollectionView</a></li><li><a href="DataView.html">DataView</a></li><li><a href="LayoutView.html">LayoutView</a></li><li><a href="Region.html">Region</a></li><li><a href="RegionManager.html">RegionManager</a></li><li><a href="TemplateView.html">TemplateView</a></li><li><a href="View.html">View</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Thu Aug 13 2015 02:31:51 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
