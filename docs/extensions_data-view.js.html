<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: extensions/data-view.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: extensions/data-view.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { TemplateView } from '../templateview';
import { normalizeUIKeys } from '../view';
import { utils } from '../utils';
export class DataView extends TemplateView {
    /**
     * DataView
     * @param {DataViewOptions} options
     * @extends TemplateView
     */
    constructor(options) {
        super(options);
        if (options.model) {
            this._model = options.model;
        }
        if (options.collection) {
            this._collection = options.collection;
        }
    }
    get model() { return this._model; }
    set model(model) {
        this.setModel(model);
    }
    get collection() { return this._collection; }
    set collection(collection) {
        this.setCollection(collection);
    }
    setModel(model) {
        if (this._model === model)
            return;
        this.triggerMethod('before:model', this._model, model);
        if (this._model) {
            this.stopListening(this._model);
        }
        this._model = model;
        this.triggerMethod('model', model);
    }
    setCollection(collection) {
        if (this._collection === collection)
            return;
        this.triggerMethod('before:collection', this._collection, collection);
        if (this._collection) {
            this.stopListening(this._collection);
        }
        this._collection = collection;
        this.triggerMethod('collection', collection);
    }
    getTemplateData() {
        return this.model ? this.model.toJSON() : {};
    }
    delegateEvents(events) {
        events = events || this.events;
        events = normalizeUIKeys(events);
        let { c, e, m } = this._filterEvents(events);
        super.delegateEvents(e);
        this._delegateDataEvents(m, c);
        return this;
    }
    undelegateEvents() {
        this._undelegateDataEvents();
        super.undelegateEvents();
        return this;
    }
    _delegateDataEvents(model, collection) {
        this._dataEvents = {};
        let fn = (item, ev) => {
            if (!this[item])
                return {};
            let out = {}, k, f;
            for (k in ev) {
                f = utils.bind(ev[k], this);
                this[item].on(k, f);
                out[item + ":" + k] = f;
            }
            return out;
        };
        utils.extend(this._dataEvents, fn('model', model), fn('collection', collection));
    }
    _undelegateDataEvents() {
        if (!this._dataEvents)
            return;
        let k, v;
        for (k in this._dataEvents) {
            v = this._dataEvents[k];
            let [item, ev] = k.split(':');
            if (!this[item])
                continue;
            this[item].off(ev, v);
        }
        delete this._dataEvents;
    }
    _filterEvents(obj) {
        /*jshint -W030 */
        let c = {}, m = {}, e = {}, k, v;
        for (k in obj) {
            let [ev, t] = k.split(' ');
            ev = ev.trim(), t = t ? t.trim() : "", v = obj[k];
            if (t === 'collection') {
                c[ev] = v;
            }
            else if (t === 'model') {
                m[ev] = v;
            }
            else {
                e[k] = v;
            }
        }
        return { c, m, e };
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-utils.html">utils</a></li></ul><h3>Classes</h3><ul><li><a href="-_.html"></a></li><li><a href="BaseObject.html">BaseObject</a></li><li><a href="BaseView.html">BaseView</a></li><li><a href="CollectionView.html">CollectionView</a></li><li><a href="DataView.html">DataView</a></li><li><a href="LayoutView.html">LayoutView</a></li><li><a href="Region.html">Region</a></li><li><a href="RegionManager.html">RegionManager</a></li><li><a href="TemplateView.html">TemplateView</a></li><li><a href="View.html">View</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Thu Aug 06 2015 03:59:49 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
