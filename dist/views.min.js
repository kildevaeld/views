!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.views=e():t.views=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}n(i(1)),n(i(6)),n(i(5)),n(i(4)),n(i(3)),n(i(2)),n(i(7)),n(i(8)),n(i(9)),n(i(10)),n(i(11)),n(i(12)),n(i(13))},function(t,e,i){function n(t,e){var i,n,o,r,s,h={};for(i in t)n=t[i],null!==(o=l.exec(i))&&(s=o[1],r=e[s],null!=r&&(i=i.replace(o[0],r))),h[i]=n;return h}var o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},r=i(2),s=i(5),l=/@ui.([a-zA-Z_\-\$#]+)/i;e.normalizeUIKeys=n;var h=function(t){function e(e){this._options=e,t.call(this,e)}return o(e,t),e.prototype.delegateEvents=function(e){this.bindUIElements(),e=e||this.events,e=n(e,this._ui);var i=this._configureTriggers();return e=s.utils.extend({},e,i),t.prototype.delegateEvents.call(this,e),this},e.prototype.undelegateEvents=function(){return this.unbindUIElements(),t.prototype.undelegateEvents.call(this),this},e.prototype.bindUIElements=function(){var t=this,e=this.getOption("ui");e&&(this._ui||(this._ui=e),e=s.utils.result(this,"_ui"),this.ui={},Object.keys(e).forEach(function(i){var n=t.$(e[i]);n&&n.length&&(n instanceof NodeList&&(n=n[0]),t.ui[i]=n)}))},e.prototype.unbindUIElements=function(){this.ui={}},e.prototype._configureTriggers=function(){var t=this.getOption("triggers")||{};"function"==typeof t&&(t=t.call(this)),t=n(t,this._ui);var e,i,o={};for(i in t)e=t[i],o[i]=this._buildViewTrigger(e);return o},e.prototype._buildViewTrigger=function(t){"string"==typeof t&&(t={event:t});var e=s.utils.extend({preventDefault:!0,stopPropagation:!0},t);return function(t){t&&(t.preventDefault&&e.preventDefault&&t.preventDefault(),t.stopPropagation&&e.stopPropagation&&t.stopPropagation()),this.triggerMethod(e.event,{view:this,model:this.model,collection:this.collection})}},e}(r.BaseView);e.View=h},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(3),r=i(5),s=/^\s*</,l="focus blur change".split(" "),h=["el","id","attributes","className","tagName","events"],u=function(t){function e(e){void 0===e&&(e={}),this._cid=r.utils.uniqueId("view"),r.utils.extend(this,r.utils.pick(e,h)),this._domEvents=[],null==this.el&&this._ensureElement(),t.call(this,e)}return n(e,t),e.find=function(t,e){return e.querySelectorAll(t)},Object.defineProperty(e.prototype,"cid",{get:function(){return this._cid},enumerable:!0,configurable:!0}),e.prototype.delegateEvents=function(t){var e=this;if(!t&&!(t=r.utils.result(this,"events")))return this;this.undelegateEvents();var i=[];for(var n in t){var o=t[n];"function"!=typeof o&&(o=this[o]);var s=n.match(/^(\S+)\s*(.*)$/),l=r.utils.bind(o,this);s[2]?this.delegate(s[1],s[2],l):i.push([s[1],l])}return i.forEach(function(t){e.delegate(t[0],t[1])}),this},e.prototype.undelegateEvents=function(){if(this.el){for(var t=0,e=this._domEvents.length;e>t;t++){var i=this._domEvents[t];r.html.removeEventListener(this.el,i.eventName,i.handler)}this._domEvents.length=0}return this},e.prototype.delegate=function(t,e,i){"function"==typeof e&&(i=e,e=null);var n=this.el,o=e?function(t){var o=t.target||t.srcElement;if(!t.delegateTarget)for(;o&&o!=n;o=o.parentNode)r.html.matches(o,e)&&(t.delegateTarget=o,i(t))}:function(t){t.delegateTarget||i(t)},s=!!~l.indexOf(t)&&null!=e;return r.html.addEventListener(this.el,t,o,s),this._domEvents.push({eventName:t,handler:o,listener:i,selector:e}),o},e.prototype.undelegate=function(t,e,i){if("function"==typeof e&&(i=e,e=null),this.el)for(var n=this._domEvents.slice(),o=0,s=n.length;s>o;o++){var l=n[o],h=l.eventName===t&&(i?l.listener===i:!0)&&(e?l.selector===e:!0);h&&(r.html.removeEventListener(this.el,l.eventName,l.handler),this._domEvents.splice(r.utils.indexOf(n,l),1))}return this},e.prototype.render=function(t){return this},e.prototype.appendTo=function(t){return t.appendChild(this.el),this},e.prototype.append=function(t,e){if(null!=e){var i=this.$(e);i instanceof NodeList&&i.length>0?i[0].appendChild(t):i instanceof HTMLElement&&i.appendChild(t)}else this.el.appendChild(t);return this},e.prototype.$=function(t){return t instanceof HTMLElement?t:e.find(t,this.el)},e.prototype.setElement=function(t){this.undelegateEvents(),this._setElement(t),this.delegateEvents()},e.prototype.remove=function(){return this._removeElement(),this},e.prototype._createElement=function(t){return document.createElement(t)},e.prototype._ensureElement=function(){if(this.el)this.setElement(r.utils.result(this,"el"));else{var t=r.utils.extend({},r.utils.result(this,"attributes"));this.id&&(t.id=r.utils.result(this,"id")),this.className&&(t["class"]=r.utils.result(this,"className")),this.setElement(this._createElement(r.utils.result(this,"tagName")||"div")),this._setAttributes(t)}},e.prototype._removeElement=function(){this.undelegateEvents(),this.el.parentNode&&this.el.parentNode.removeChild(this.el)},e.prototype._setElement=function(t){if("string"==typeof t)if(s.test(t)){var e=document.createElement("div");e.innerHTML=t,this.el=e.firstElementChild}else this.el=document.querySelector(t);else this.el=t},e.prototype._setAttributes=function(t){for(var e in t)e in this.el?this.el[e]=t[e]:this.el.setAttribute(e,t[e])},e}(o.BaseObject);e.BaseView=u},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(4),r=i(5),s=function(t){function e(e){t.call(this),this._isDestroyed=!1,"function"==typeof this.initialize&&r.utils.call(this.initialize,this,r.utils.slice(arguments))}return n(e,t),Object.defineProperty(e.prototype,"isDestroyed",{get:function(){return this._isDestroyed},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy"),this.stopListening(),this.off(),this._isDestroyed=!0,this.triggerMethod("destroy"),Object.freeze(this),this)},e.prototype.triggerMethod=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return r.utils.triggerMethodOn(this,t,e),this},e.prototype.getOption=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this.options&&e.push(this.options),this._options&&e.push(this._options),e.push(this),r.utils.getOption(t,e)},e.extend=r.extend,e}(o.EventEmitter);e.BaseObject=s},function(t,e){function i(){return""+ ++n}var n=0,o=function(){function t(){}return Object.defineProperty(t.prototype,"listeners",{get:function(){return this._listeners},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,i,n){void 0===n&&(n=!1);var o=(this._listeners||(this._listeners={}))[t]||(this._listeners[t]=[]);return o.push({name:t,once:n,handler:e,ctx:i||this}),this},t.prototype.once=function(t,e,i){return this.on(t,e,i,!0)},t.prototype.off=function(t,e){if(null==t)this._listeners={};else if(this._listeners[t]){var i=this._listeners[t];if(null==e)this._listeners[t]=[];else for(var n=0;n<i.length;n++){{i[n]}i[n].handler==e&&this._listeners[t].splice(n,1)}}},t.prototype.trigger=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=(this._listeners||(this._listeners={}))[e]||(this._listeners[e]=[]).concat(this._listeners.all||[]);t.debugCallback&&t.debugCallback(this.constructor.name,this.name,e,i);{var r,s,l,h;o.length}for(h=0;h<o.length;h++)r=o[h],s=i,"all"==r.name&&(s=[e].concat(i)),r.handler.apply(r.ctx,s),r.once===!0&&(l=this._listeners[r.name].indexOf(r),this._listeners[r.name].splice(l,1));return this},t.prototype.listenTo=function(t,e,n,o,r){void 0===r&&(r=!1);var s,l,h;return s=this._listeningTo||(this._listeningTo={}),l=t.listenId||(t.listenId=i()),s[l]=t,h=r?"once":"on",t[h](e,n,this),this},t.prototype.listenToOnce=function(t,e,i,n){return this.listenTo(t,e,i,n,!0)},t.prototype.stopListening=function(t,e,i){var n=this._listeningTo||{},o=!e&&!i;t&&(n[t.listenId]=t);for(var r in n)t=n[r],t.off(e,i,this),(o||!Object.keys(t.listeners).length)&&delete this._listeningTo[r];return this},t}();e.EventEmitter=o},function(t,e){function i(t,e){var i,n=this;i=t&&u.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},u.extend(i,n,e);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&u.extend(i.prototype,t),i.__super__=n.prototype,i}function n(t,e,i,o){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;var r=toString.call(t);if(r!=toString.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!==+t?e!==+e:0===t?1/t===1/e:t===+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return o[s]==e;var l=t.constructor,h=e.constructor;if(l!==h&&!("function"==typeof l&&l instanceof l&&"function"==typeof h&&h instanceof h))return!1;i.push(t),o.push(e);var c=0,a=!0;if("[object Array]"===r){if(c=t.length,a=c===e.length)for(;c--&&(a=n(t[c],e[c],i,o)););}else{for(var p in t)if(u.has(t,p)&&(c++,!(a=u.has(e,p)&&n(t[p],e[p],i,o))))break;if(a){for(p in e)if(u.has(e,p)&&!c--)break;a=!c}}return i.pop(),o.pop(),a}var o="undefined"!=typeof Element&&Element.prototype||{},r=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||function(t){var e=(this.parentNode||document).querySelectorAll(t)||[];return!!~u.indexOf(e,this)},s=o.addEventListener||function(t,e){return this.attachEvent("on"+t,e)},l=o.removeEventListener||function(t,e){return this.detachEvent("on"+t,e)};e.extend=i;var h;!function(t){function e(t,e){return r.call(t,e)}function i(t,e,i,n){void 0===n&&(n=!1),s.call(t,e,i,n)}function n(t,e,i){l.call(t,e,i)}function o(t,e){t.classList?t.classList.add(e):t.className=t.className.split(" ").concat(e.split(" ")).join(" ")}function h(t,e){t.classList?t.classList.remove(e):t.className=t.className.split(" ").concat(e.split(" ")).join(" ")}t.matches=e,t.addEventListener=i,t.removeEventListener=n,t.addClass=o,t.removeClass=h}(h=e.html||(e.html={}));var u,c=Function.prototype.bind,a=0;!function(t){function e(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function i(t){return void 0===t&&(t=""),t+ ++a}function o(t){return t===Object(t)}function r(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];if(!t.isObject(e))return e;for(var o,r,s=0;s<i.length;s++)if(o=i[s],t.isObject(o))for(r in o)t.has(o,r)&&(e[r]=o[r]);return e}function s(e,i){for(var n,o={},r=0;r<i.length;r++)n=i[r],t.has(e,n)&&(o[n]=e[n]);return o}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function h(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1}function u(e,i,n,o){var r=e[i];return"function"==typeof r?t.call(r,n,o||[]):r}function p(e){var i=[];for(var n in e)t.has(e,n)&&i.push(e[n]);return i}function f(t,e,i){var n,o;for(n=0;n<t.length;n++)if(o=t[n],e.call(i,o))return o;return null}function d(e,i,n){Array.isArray(n)||(n=[n]),n.forEach(function(n){"function"==typeof i[n]&&(e[n]=t.bind(i[n],i))})}function g(e,i){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if("function"!=typeof e)throw new Error("method not at function");if(null!=c)return c.call.apply(c,[e,i].concat(n));n=n||[];var r=function(){},s=function(){var o=this instanceof r?this:i;return t.call(e,o,n.concat(t.slice(arguments)))};return r.prototype=this.prototype,s.prototype=new r,s}function y(t,e,i){switch(void 0===i&&(i=[]),i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2]);case 4:return t.call(e,i[0],i[1],i[2],i[3]);case 5:return t.call(e,i[0],i[1],i[2],i[3],i[4]);default:return t.apply(e,i)}}function v(t){return Array.prototype.slice.call(t)}function m(t,e){return n(t,e,[],[])}function _(i,n,o){var r=e("on-"+n.replace(":","-"));i[r]&&"function"==typeof i[r]&&t.call(i[r],i,o),"function"==typeof i.trigger&&(o=[n].concat(o),t.call(i.trigger,i,o))}function b(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(o(n)&&n[t])return n[t]}return null}function w(t,e,i){var n="function"==typeof e?e:function(t){return t[e]};return t.map(function(t,e,o){return{value:t,index:e,criteria:n.call(i,t,e,o)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}).map(function(t){return t.value})}t.camelcase=e,t.uniqueId=i,t.isObject=o,t.extend=r,t.pick=s,t.has=l,t.indexOf=h,t.result=u,t.values=p,t.find=f,t.proxy=d,t.bind=g,t.call=y,t.slice=v,t.equal=m,t.triggerMethodOn=_,t.getOption=b,t.sortBy=w}(u=e.utils||(e.utils={}))},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(1),r=function(t){function e(e){e&&e.template&&(this.template=e.template),t.call(this,e)}return n(e,t),e.prototype.getTemplateData=function(){return{}},e.prototype.render=function(t){this.triggerMethod("before:render"),this.undelegateEvents();var e=this.getOption("template");return"function"==typeof e&&(e=e.call(this,this.getTemplateData())),e&&"string"==typeof e&&(this.el.innerHTML=e),this.delegateEvents(),this.triggerMethod("render"),this},e}(o.View);e.TemplateView=r},function(t,e,i){function n(t,e){if(void 0===t&&(t={}),!t.selector)throw new Error("No selector specified: "+t);return o(t.selector,t.regionClass||h,e)}function o(t,e,i){void 0===e&&(e=h),i=i||document;var n=i.querySelector(t);if(!n)throw new Error("selector must exist in the dom");return new e({el:n})}var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},s=i(3),l=i(5),h=function(t){function e(e){this.options=e,this._el=this.getOption("el"),t.call(this)}return r(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},set:function(t){this.show(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),e.buildRegion=function(t,i){return void 0===i&&(i=null),t instanceof e?t:"string"==typeof t?o(t,e,i):n(t,i)},e.prototype.show=function(t,e){var i=t!==this._view;return i&&(this.empty(),t.once("destroy",this.empty,this),t.once("render",function(){l.utils.triggerMethodOn(t,"show")}),t.render(),l.utils.triggerMethodOn(t,"before:show"),this._attachHtml(t),this._view=t),this},e.prototype.destroy=function(){this.empty(),t.prototype.destroy.call(this)},e.prototype.empty=function(){if(this._view){var t=this._view;return t.off("destroy",this.empty,this),this.trigger("before:empty",t),this._destroyView(),this.trigger("empty",t),delete this._view,this}},e.prototype._attachHtml=function(t){this._el.innerHTML="",this._el.appendChild(t.el)},e.prototype._destroyView=function(){var t=this._view;t.destroy&&"function"==typeof t.destroy&&!t.isDestroyed?t.destroy():t.remove&&"function"==typeof t.remove&&t.remove(),this._el.innerHTML=""},e}(s.BaseObject);e.Region=h},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(3),r=i(7),s=i(5),l=function(t){function e(){t.call(this),this._regions={}}return n(e,t),Object.defineProperty(e.prototype,"regions",{get:function(){return this._regions},enumerable:!0,configurable:!0}),e.prototype.addRegions=function(t){var e,i={},n=Object.keys(t);return n.forEach(function(n){e=t[n],i[n]=this.addRegion(n,e)},this),i},e.prototype.addRegion=function(t,e){var i=r.Region.buildRegion(e);return this._setRegion(t,i),i},e.prototype.removeRegion=function(t){"string"==typeof t&&(t=[t]),t.forEach(function(t){if(s.utils.has(this.regions,t)){var e=this.regions[t];e.destroy(),this._unsetRegion(t)}},this)},e.prototype.destroy=function(){this.removeRegions(),t.prototype.destroy.call(this)},e.prototype.removeRegions=function(){this.removeRegion.apply(this,Object.keys(this._regions))},e.prototype._setRegion=function(t,e){this._regions[t]=e},e.prototype._unsetRegion=function(t){delete this._regions[t]},e}(o.BaseObject);e.RegionManager=l},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(6),r=i(8),s=i(5),l=i(7),h=function(t){function e(e){this._regionManager=new r.RegionManager,s.utils.proxy(this,this._regionManager,["removeRegion","removeRegions"]);var i=this.getOption("regions");this.listenTo(this,"render",function(){this.addRegion(i)}),t.call(this,e)}return n(e,t),Object.defineProperty(e.prototype,"regions",{get:function(){return this._regionManager.regions},enumerable:!0,configurable:!0}),e.prototype.addRegion=function(t,e){var i={};if("string"==typeof t){if(null==e)throw new Error("add region");i[t]=e}else i=t;for(var n in i){var o=l.Region.buildRegion(i[n],this.el);this._regionManager.addRegion(n,o)}},e.prototype.removeRegion=function(t){this._regionManager.removeRegion(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this._regionManager.destroy()},e}(o.TemplateView);e.LayoutView=h},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(6),r=i(5),s=function(t){function e(e){e.model&&(this._model=e.model),e.collection&&(this._collection=e.collection),t.call(this,e)}return n(e,t),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},set:function(t){this.setModel(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collection",{get:function(){return this._collection},set:function(t){this.setCollection(t)},enumerable:!0,configurable:!0}),e.prototype.setModel=function(t){this._model!==t&&(this.triggerMethod("before:model",this._model,t),this._model&&this.stopListening(this._model),this._model=t,this.triggerMethod("model",t))},e.prototype.setCollection=function(t){this._collection!==t&&(this.triggerMethod("before:collection",this._collection,t),this._collection&&this.stopListening(this._collection),this._collection=t,this.triggerMethod("collection",t))},e.prototype.getTemplateData=function(){return this.model?"function"==typeof this.model.toJSON?this.model.toJSON():this.model:{}},e.prototype.delegateEvents=function(e){e=e||this.events;var i=this._filterEvents(e),n=i.c,o=i.e,r=i.m;return t.prototype.delegateEvents.call(this,o),this._delegateDataEvents(r,n),this},e.prototype.undelegateEvents=function(){return this._undelegateDataEvents(),t.prototype.undelegateEvents.call(this),this},e.prototype._delegateDataEvents=function(t,e){var i=this;this._dataEvents={};var n=function(t,e){if(!i[t])return{};var n,o,s={};for(n in e)o=r.utils.bind(e[n],i),i[t].on(n,o),s[t+":"+n]=o;return s};r.utils.extend(this._dataEvents,n("model",t),n("collection",e))},e.prototype._undelegateDataEvents=function(){if(this._dataEvents){var t,e;for(t in this._dataEvents){e=this._dataEvents[t];var i=t.split(":"),n=i[0],o=i[1];this[n]&&this[n].off(o,e)}delete this._dataEvents}},e.prototype._filterEvents=function(t){var e,i,n={},o={},r={};for(e in t){var s=e.split(" "),l=s[0],h=s[1];l=l.trim(),h=h?h.trim():"",i=t[e],"collection"===h?n[l]=i:"model"===h?o[l]=i:r[e]=i}return{c:n,m:o,e:r}},e}(o.TemplateView);e.DataView=s},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(10),r=i(5),s=function(){function t(){this.children=[],this.buffer=document.createDocumentFragment()}return t.prototype.append=function(t){this.children.push(t),this.buffer.appendChild(t.el)},t}(),l=function(t){function e(e){this.children=[],t.call(this,e)}return n(e,t),e.prototype.render=function(e){return this.destroyChildren(),this._destroyContainer(),t.prototype.render.call(this,e),this._initContainer(),this.collection&&this.collection.length&&this.renderCollection(),this},e.prototype.setCollection=function(e){t.prototype.setCollection.call(this,e),this._delegateCollectionEvents()},e.prototype.renderCollection=function(){this.destroyChildren(),0!=this.collection.length?(this.hideEmptyView(),this._startBuffering(),this._renderCollection(),this._stopBuffering()):this.showEmptyView()},e.prototype.getChildView=function(t){var e=this.getOption("childView")||o.DataView,i=this.getOption("childViewOptions")||{};return new e(r.utils.extend({model:t},i))},e.prototype.renderChildView=function(t,e){this.triggerMethod("before:render:child",t),t.render(),this._attachHTML(t,e),this.triggerMethod("render:child",t)},e.prototype.showEmptyView=function(){},e.prototype.hideEmptyView=function(){},e.prototype.destroyChildren=function(){this._container&&(this._container.innerHTML=""),0!==this.children.length&&(this.children.forEach(this.removeChildView,this),this.children=[])},e.prototype.removeChildView=function(t){t&&("function"==typeof t.destroy&&t.destroy(),"function"==typeof t.remove&&t.remove(),this.stopListening(t),this.children.splice(this.children.indexOf(t),1),0===this.children.length&&this.showEmptyView(),this._updateIndexes(t,!1))},e.prototype.destroy=function(){return this.triggerMethod("before:destroy:children"),this.destroyChildren(),this.triggerMethod("destroy:children"),this.hideEmptyView(),t.prototype.destroy.call(this)},e.prototype._renderCollection=function(){var t=this;this.triggerMethod("before:render:collection"),this.collection.forEach(function(e){var i=t.getChildView(e);t._appendChild(i)}),this.triggerMethod("render:collection")},e.prototype._appendChild=function(t,e){this._updateIndexes(t,!0,e),this._proxyChildViewEvents(t),this.children.push(t),this.hideEmptyView(),this.renderChildView(t,e),this.triggerMethod("add:child",t)},e.prototype._attachHTML=function(t,e){this._buffer?this._buffer.append(t):this._insertBefore(t,e)||this._insertAfter(t)},e.prototype._proxyChildViewEvents=function(t){var e=this.getOption("prefix")||"childview";this.listenTo(t,"all",function(){var i=r.utils.slice(arguments);i[0]=e+":"+i[0],i.splice(1,0,t),r.utils.call(this.triggerMethod,this,i)})},e.prototype._updateIndexes=function(t,e,i){this.sort&&this.children.forEach(function(i){i._index>=t._index&&(e?i._index++:i._index--)})},e.prototype._startBuffering=function(){this._buffer=new s},e.prototype._stopBuffering=function(){this._container.appendChild(this._buffer.buffer),delete this._buffer},e.prototype._initContainer=function(){var t=this.getOption("childViewContainer");t=t?this.$(t)[0]:this.el,this._container=t},e.prototype._destroyContainer=function(){this._container&&delete this._container},e.prototype._insertBefore=function(t,e){var i,n=this.sort&&e<this.children.length-1;return n&&(i=r.utils.find(this.children,function(t){return t._index===e+1})),i?(this._container.insertBefore(t.el,i.el),!0):!1},e.prototype._insertAfter=function(t){this._container.appendChild(t.el)},e.prototype._delegateCollectionEvents=function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._onCollectionSort))},e.prototype._onCollectionAdd=function(t){var e=this.getChildView(t),i=this.collection.indexOf(t);this._appendChild(e,i)},e.prototype._onCollectionRemove=function(t){var e=r.utils.find(this.children,function(e){return e.model===t});this.removeChildView(e)},e.prototype._onCollectionSort=function(){},e}(o.DataView);e.CollectionView=l},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(5),r=i(3),s=function(t){function e(e,i){void 0===e&&(e={}),i=i||{},this._attributes=e,this.uid=o.utils.uniqueId("uid"),this._changed={},this.collection=i.collection,t.call(this)}return n(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.idAttribute in this._attributes?this._attributes[this.idAttribute]:this.uid},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,i){void 0===i&&(i={});var n,r,s,l,h,u,c,a={};if(null==t)return this;"object"==typeof t?(a=t,i=e):a[t]=e,i||(i={}),r=i.unset,l=i.silent,s=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=o.utils.extend(Object.create(null),this._attributes),this._changed={}),c=this._attributes,u=this._previousAttributes;for(n in a)e=a[n],o.utils.equal(c[n],e)||s.push(n),o.utils.equal(u[n],e)?delete this._changed[n]:this._changed[n]=e,r?delete c[n]:c[n]=e;if(!l){s.length&&(this._pending=!!i);for(var p=0,f=s.length;f>p;p++)this.trigger("change:"+s[p],this,c[s[p]],i)}if(h)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},e.prototype.get=function(t){return this._attributes[t]},e.prototype.unset=function(t,e){this.set(t,void 0,o.utils.extend({},e,{unset:!0}))},e.prototype.has=function(t){return null!=this.get(t)},e.prototype.hasChanged=function(t){return null==t?!!Object.keys(this.changed).length:o.utils.has(this.changed,t)},e.prototype.clear=function(t){var e={};for(var i in this._attributes)e[i]=void 0;return this.set(e,o.utils.extend({},t,{unset:!0}))},Object.defineProperty(e.prototype,"changed",{get:function(){return o.utils.extend({},this._changed)},enumerable:!0,configurable:!0}),e.prototype.changedAttributes=function(t){if(!t)return this.hasChanged()?o.utils.extend(Object.create(null),this.changed):!1;var e,i={},n=this._changing?this._previousAttributes:this._attributes;for(var r in t)o.utils.equal(n[r],e=t[r])||((i||(i={}))[r]=e);return i},e.prototype.previous=function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},e.prototype.previousAttributes=function(){return o.utils.extend(Object.create(null),this._previousAttributes)},e.prototype.toJSON=function(){return JSON.parse(JSON.stringify(this._attributes))},e.prototype.clone=function(){return new this.constructor(this._attributes)},e}(r.BaseObject);e.Model=s},function(t,e,i){var n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},o=i(3),r=i(5),s=i(12),l={add:!0,remove:!0,merge:!0},h={add:!0,remove:!1},u=function(t){function e(e,i){void 0===i&&(i={}),this.options=i,this.options.model&&(this.Model=this.options.model),e&&this.add(e),t.call(this)}return n(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.models.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Model",{get:function(){return this._model||(this._model=s.Model),this._model},set:function(t){this._model=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"models",{get:function(){return this._models||(this._models=[])},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e){var i=this;void 0===e&&(e={}),Array.isArray(t)?t=t.map(function(t){return t instanceof i.Model?t:i.create(t,{add:!1})}):t instanceof this.Model||(t=this.create(t,{add:!1})),this.set(t,r.utils.extend({merge:!1},e,h))},e.prototype.set=function(t,e){void 0===e&&(e={}),e=r.utils.extend({},l,e),e.parse&&(t=this.parse(t,e));var i,n,o,s,h,u,c,a=!Array.isArray(t),p=a?t?[t]:[]:t.slice(),f=e.at,d=this.comparator&&null==f&&e.sort!==!1,g="string"==typeof this.comparator?this.comparator:null,y=[],v=[],m={},_=e.add,b=e.merge,w=e.remove,E=!d&&_&&w?[]:null;for(i=0,n=p.length;n>i;i++){if(s=p[i],o=s.get(s.idAttribute)||s.uid,u=this.get(o))w&&(m[u.uid]=!0),b&&(h=s.toJSON(),u.set(h,e),d&&!c&&u.hasChanged(g)&&(c=!0)),p[i]=u;else if(_){if(p[i]=s,!s)continue;y.push(s),this._addReference(s,e)}s=u||s,E&&!m[s.id]&&E.push(s),m[s.uid]=!0}if(w){for(i=0,n=this.length;n>i;++i)m[(s=this.models[i]).uid]||v.push(s);v.length&&this.remove(v,e)}if(y.length||E&&E.length)if(d&&(c=!0),this.length+=y.length,null!=f)for(i=0,n=y.length;n>i;i++)this.models.splice(f+i,0,y[i]);else{E&&(this.models.length=0);var O=E||y;for(i=0,n=O.length;n>i;i++)this.models.push(O[i])}if(c&&this.sort({silent:!0}),!e.silent){for(i=0,n=y.length;n>i;i++)(s=y[i]).trigger("add",s,this,e);(c||E&&E.length)&&this.trigger("sort",this,e),(y.length||v.length)&&this.trigger("update",this,e)}return a?p[0]:p},e.prototype.remove=function(t,e){void 0===e&&(e={});var i=!Array.isArray(t);t=i?[t]:t.slice();var n,o,r,s;for(n=0,o=t.length;o>n;n++)s=t[n]=this.get(t[n]),s&&(r=this.indexOf(s),this.models.splice(r,1),e.silent||(e.index=r,s.trigger("remove",s,this,e)),this._removeReference(s,e));return i?t[0]:t},e.prototype.get=function(t){return this.find(t)},e.prototype.at=function(t){return this.models[t]},e.prototype.clone=function(t){return t=t||this.options,new this.constructor(this.models,t)},e.prototype.sort=function(t){if(void 0===t&&(t={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");return"string"==typeof this.comparator||1===this.comparator.length?this._models=this.sortBy(this.comparator,this):this.models.sort(this.comparator.bind(this)),t.silent||this.trigger("sort",this,t),this},e.prototype.sortBy=function(t,e){return r.utils.sortBy(this._models,t,e)},e.prototype.push=function(t,e){return void 0===e&&(e={}),this.add(t,r.utils.extend({at:this.length},e))},e.prototype.reset=function(t,e){var i=this;return void 0===e&&(e={}),this.forEach(function(t){i._removeReference(t,e)}),e.previousModels=this.models,this._reset(),t=this.add(t,e),e.silent||this.trigger("reset",this,e),t},e.prototype.create=function(t,e){void 0===e&&(e={add:!0});var i=new this.Model(t,e);return e.add&&this.add(i),i},e.prototype.parse=function(t,e){return void 0===e&&(e={}),t},e.prototype.find=function(t){var e;return e="function"==typeof t?r.utils.find(this.models,t):r.utils.find(this.models,function(e){return e.id==t||e.uid==t})},e.prototype.forEach=function(t,e){for(var i=0,n=this.models.length;n>i;i++)t.call(e||this,this.models[i],i);return this},e.prototype.indexOf=function(t){return this.models.indexOf(t)},e.prototype.toJSON=function(){return this.models.map(function(t){return t.toJSON()})},e.prototype.comparator=function(){},e.prototype._removeReference=function(t,e){this===t.collection&&delete t.collection,this.stopListening(t)},e.prototype._addReference=function(t,e){t.collection||(t.collection=this),this.listenTo(t,"all",this._onModelEvent)},e.prototype._reset=function(){this._models=[]},e.prototype._onModelEvent=function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),r.utils.call(this.trigger,this,r.utils.slice(arguments)))},e}(o.BaseObject);e.Collection=u}])});